* [[https://www.jianshu.com/p/6b41f8032f8e][ThinkPHP5和ThinkPHP6的区别 - 简书]] :website:

[2020-09-22 二 11:53]

** Article

#+BEGIN_QUOTE
  本文作者：陈进坚\\
  个人博客： [[https://links.jianshu.com/go?to=https%3A%2F%2Fjian1098.github.io][https://jian1098.github.io]]\\
  CSDN 博客： [[https://links.jianshu.com/go?to=https%3A%2F%2Fblog.csdn.net%2Fc_jian][https://blog.csdn.net/c\_jian]]\\
  简书： [[https://www.jianshu.com/u/8ba9ac5706b6]]\\
  联系方式： [[https://links.jianshu.com/go?to=mailto%3Ajian1098%40qq.com][jian1098@qq.com]]
#+END_QUOTE

*** 1.安装方式


thinkphp6 只能通过 =composer=安装

#+BEGIN_EXAMPLE
     composer config -g repo.packagist composer https://mirrors.aliyun.com/composer      # 设置composer为阿里云镜像,解决国内使用composer慢的问题
    composer create-project topthink/think myproject            # 安装稳定版,myproject为你的项目名
#+END_EXAMPLE

*** 2.配置文件


thinkphp5 里面的 =config.php=被拆分成了 =app、cache、database、route=等等模块，放在了 =config=文件夹；

thinkphp6 新引入了一个 =.env=的文件，可以通过读取这个环境设置去配置数据库等等

*** 3.自带 web 服务


直接 =php think run=就可以在本地启动一个 web 服务器，还可以用 =-p=参数指定端口

*** 4.目录结构


=application=文件夹重命名为 =app=；

thinkphp5 核心框架是项目根目录 =thinkphp=下 , thinkphp6是 =vendor/topthink=

*** 5.控制器


之前继承 =think\Controller=类，现在改为继承 =BaseController=

*** 6.跨域


只需要在 =middleware.php=中注册 =\think\middleware\AllowCrossDomain=就可以搞定跨域问题

*** 7.组件独立


独立 ORM

独立模版引擎

*** 8.严格模式


thinkphp6 使用了 php7 严格模式

*** 9.引入 Filesystem


*** 10.支持多应用入口


admin 应用可以设置 =admin.php=入口文件来访问；api 应用可以设置 =api.php=入口文件来访问。

如果要使用多应用模式，你需要安装多应用模式扩展

#+BEGIN_EXAMPLE
     composer require topthink/think-multi-app
#+END_EXAMPLE

然后你的应用目录结构需要做如下调整，主要区别在 app 目录增加了应用子目录，然后配置文件和路由定义文件都纳入应用目录下

#+BEGIN_EXAMPLE
     ├─app 应用目录
    │  ├─index              主应用
    │  │  ├─controller      控制器目录
    │  │  ├─model           模型目录
    │  │  ├─view            视图目录
    │  │  ├─config          配置目录
    │  │  ├─route           路由目录
    │  │  └─ ...            更多类库目录
    │  │ 
    │  ├─admin              后台应用
    │  │  ├─controller      控制器目录
    │  │  ├─model           模型目录
    │  │  ├─view            视图目录
    │  │  ├─config          配置目录
    │  │  ├─route           路由目录
    │  │  └─ ...            更多类库目录
    │
    ├─public                WEB目录（对外访问目录）
    │  ├─admin.php          后台入口文件
    │  ├─index.php          入口文件
    │  ├─router.php         快速测试文件
    │  └─.htaccess          用于apache的重写
    │
    ├─config                全局应用配置目录
    ├─runtime               运行时目录
    │  ├─index              index应用运行时目录
    │  └─admin              admin应用运行时目录
#+END_EXAMPLE

支持在同一个入口文件中访问多个应用，并且支持应用的映射关系以及自定义。如果你通过 =index.php=入口文件访问的话，并且没有设置应用 =name=，系统自动采用自动多应用模式。

自动多应用模式的 URL 地址默认使用

#+BEGIN_EXAMPLE
     // 访问admin应用
    http://serverName/index.php/admin
    // 访问shop应用
    http://serverName/index.php/shop
#+END_EXAMPLE

以通过 =app.php=配置文件的 =default_app=配置参数指定默认应用

#+BEGIN_EXAMPLE
     // 设置默认应用名称
    'default_app' => 'home',
#+END_EXAMPLE

*** 11.域名绑定应用


=config/app.php= 配置文件中定义域名和应用的绑定

#+BEGIN_EXAMPLE
     'domain_bind' => [
        'www.a.com' => 'index',     // 域名绑定到www应用
        'admin.a.com' => 'admin',   // admin绑定到后台应用
    ], 
#+END_EXAMPLE

*** 12.自动加载


thinkphp5 真正实现了按需加载,所有类库采用自动加载机制,并且支持类库映射和 composer 类库的自动加载；

thinkphp6 使用 composer 方式实现类自动加载
